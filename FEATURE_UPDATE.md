# 新功能更新说明

## 更新内容

### 1. 交易价格自动填充
- 交易价格字段现在会自动加载并填充当前比特币价格
- 添加提示文字"默认使用当前价格，可自行修改"
- 用户仍然可以手动修改价格

### 2. 新增购买金额字段
- 在表单中新增"购买金额 (USD)"输入框
- 该字段位于"交易价格"和"数量 (BTC)"之间

### 3. 三字段联动计算
实现了三个字段的智能联动计算：
- **交易价格** × **比特币数量** = **购买金额**

#### 计算逻辑：
- 当用户输入**交易价格**或**比特币数量**时，自动计算并填充**购买金额**
- 当用户输入**购买金额**时，根据**交易价格**自动计算并填充**比特币数量**
- 自动保留适当的小数位数：
  - 购买金额保留2位小数
  - 比特币数量保留8位小数

## 技术实现

### HTML 修改
- 添加了购买金额输入框 (`transaction-total`)
- 为所有计算字段添加了提示文字 (`field-hint`)
- 调整了表单布局，保持美观性

### CSS 修改
- 添加了 `.field-hint` 样式类，用于显示字段提示文字
- 提示文字使用小字号和次要颜色，不影响主要内容

### JavaScript 修改
1. **setupCalculationListeners()** - 新增函数
   - 监听三个字段的输入事件
   - 跟踪最后修改的字段
   - 根据最后修改的字段智能计算其他字段

2. **updateBTCPrice()** - 增强功能
   - 在价格更新后，自动填充交易价格字段（仅在非编辑模式下）
   - 避免在用户编辑现有交易时覆盖价格

3. **表单重置逻辑** - 优化
   - 在添加记录后、取消编辑时，自动将价格重置为当前BTC价格
   - 确保用户体验的连贯性

4. **editTransaction()** - 增强
   - 编辑交易时，自动计算并显示购买金额

## 用户体验改进
- ✅ 减少手动计算，降低出错概率
- ✅ 提高数据录入效率
- ✅ 提供清晰的使用提示
- ✅ 保持界面简洁美观
- ✅ 支持灵活的输入方式（可从任意字段开始输入）

## 测试要点
1. 打开页面，确认交易价格自动填充当前BTC价格
2. 输入交易价格和数量，验证购买金额自动计算
3. 输入购买金额和价格，验证数量自动计算
4. 编辑现有交易，确认购买金额正确显示
5. 提交表单后，确认字段正确重置
